<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="../css/style.css" />
  
</head>
<body>
	
<div class="container_top">
<div id="left_top"></div>
<div id="middle_top">	
<h1><div class="post-title">ansible 使用</div></h1>
</h3>ansible 常用命令</h3>
<ul>
<li>ansible Host_group -a 'pwd"</li>
<li>ansible host_group -m copy -a 'src=test dest=/usr/local/src'</li>
</ul>

<h3>ansible-playbook 的使用</h3>
<p>ansible-playbook [options] playbook.yml [playbook2 ...]</p>

<p>playbook 例：</p>
<div class="mycontent"><ul>
<li>-&nbsp;name:&nbsp;Configure&nbsp;MySQL</li>
<li>&nbsp;&nbsp;hosts:&nbsp;mysqlservers</li>
<li>&nbsp;&nbsp;tasks:&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;install&nbsp;MySql</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;yum:&nbsp;name=mysql-server&nbsp;state=installed</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;Calculate&nbsp;InnoDB&nbsp;buffer&nbsp;pool&nbsp;size</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;set_fact:&nbsp;innodb_buffer_pool_size_mb="{{&nbsp;ansible_memtotal_mb&nbsp;/&nbsp;2&nbsp;}}"</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;Configure&nbsp;MySQL&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;template:&nbsp;src=templates/my.cnf&nbsp;dest=/etc/my.cnf&nbsp;owner=root&nbsp;group=root&nbsp;mode=0644&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;notify:&nbsp;restart&nbsp;mysql&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;Start&nbsp;MySQL&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;service:&nbsp;name=mysqld&nbsp;state=started&nbsp;enabled=yes&nbsp;</li>
<li>&nbsp;&nbsp;handlers:&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;name:&nbsp;restart&nbsp;mysql&nbsp;</li>
<li>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;service:&nbsp;name=mysqld&nbsp;state=restarted</li>
<li>my.cnf的配置示例：</li>
<li>#&nbsp;{{&nbsp;ansible_managed&nbsp;}}</li>
<li>[mysqld]</li>
<li>datadir=/var/lib/mysql</li>
<li>socket=/var/lib/mysql/mysql.sock</li>
<li>#&nbsp;Disabling&nbsp;symbolic-links&nbsp;is&nbsp;recommended&nbsp;to&nbsp;prevent&nbsp;assorted</li>
<li>security&nbsp;risks</li>
<li>symbolic-links=0</li>
<li>#&nbsp;Configure&nbsp;the&nbsp;buffer&nbsp;pool</li>
<li>innodb_buffer_pool_size&nbsp;=&nbsp;{{&nbsp;innodb_buffer_pool_size_mb|int&nbsp;}}M</li>
<li>[mysqld_safe]</li>
<li>log-error=/var/log/mysqld.log</li>
<li>pid-file=/var/run/mysqld/mysqld.pid</li>
<li>3、pause</li>
<li>在playbook执行的过程中暂停一定时间或者提示用户进行某些操作</li>
<li>常用参数：</li>
<li>minutes：暂停多少分钟</li>
<li>seconds：暂停多少秒</li>
<li>prompt：打印一串信息提示用户操作</li>
<li>示例：</li>
<li>&nbsp;-&nbsp;name:&nbsp;wait&nbsp;on&nbsp;user&nbsp;input</li>
<li>&nbsp;&nbsp;&nbsp;pause:&nbsp;prompt="Warning!&nbsp;Detected&nbsp;slight&nbsp;issue.&nbsp;ENTER&nbsp;to&nbsp;continue&nbsp;CTRL-C&nbsp;a&nbsp;to&nbsp;quit"&nbsp;</li>
<li>-&nbsp;name:&nbsp;timed&nbsp;wait</li>
<li>&nbsp;&nbsp;pause:&nbsp;seconds=30</li>
</ul></div>


<br>
<br />
</div>
</div>

</body>
</html>
